# ЁЯУЛ Context.md - Program All DP (Main_Program.py)

> **р╕зр╕▒р╕Щр╕Чр╕╡р╣Ир╕кр╕гр╣Йр╕▓р╕З:** 2026-01-09  
> **р╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ:** 1.1.32  
> **р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б:** `Main_Program.py` (1,878 р╕Ър╕гр╕гр╕Чр╕▒р╕Ф)

---

## ЁЯУМ р╕ар╕▓р╕Юр╕гр╕зр╕бр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б

**Program All DP** р╣Ар╕Ыр╣Зр╕Щ Launcher Application р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕зр╕бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕ер╕лр╕ер╕▓р╕вр╕Кр╕Щр╕┤р╕Фр╣Др╕зр╣Йр╣Гр╕Щр╕Чр╕╡р╣Ир╣Ар╕Фр╕╡р╕вр╕з р╕Юр╕▒р╕Тр╕Щр╕▓р╕Фр╣Йр╕зр╕в **PyQt6** Framework р╕Юр╕гр╣Йр╕нр╕бр╕гр╕░р╕Ър╕Ъ Auto-Update р╕Ир╕▓р╕Б GitHub р╣Бр╕ер╕░р╕гр╕░р╕Ър╕Ъ Logging р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Др╕Ыр╕вр╕▒р╕З Google Sheet / Telegram

---

## ЁЯПЧя╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕лр╕ер╕▒р╕Б

### р╕Др╣Ир╕▓р╕Др╕Зр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Н (Lines 72-90)
```python
# тЪая╕П р╕кр╕│р╕Др╕▒р╕Н - р╕нр╕вр╣Ир╕▓р╣Бр╕Бр╣Йр╣Др╕Вр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ
CURRENT_VERSION = "1.1.32"          # р╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ
REPO_OWNER = "Icezy159753"          # GitHub Username
REPO_NAME = "my-calculator-updates" # GitHub Repository
PROGRAM_SUBFOLDER = "All_Programs"  # р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Ар╕Бр╣Зр╕Ър╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕вр╣Ир╕нр╕в
ICON_FOLDER = "Icon"                # р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Ар╕Бр╣Зр╕Ър╣Др╕нр╕Др╕нр╕Щ
```

### URL р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╣Гр╕Щр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б (Lines 73-80)
| р╕Хр╕▒р╕зр╣Бр╕Ыр╕г | р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ |
|--------|----------|
| `GOOGLE_SCRIPT_URL` | р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б Log р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Др╕Ы Google Sheet |
| `TELEGRAM_BOT_TOKEN` | р╕кр╣Ир╕Зр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╣Др╕Ы Telegram |
| `TELEGRAM_CHAT_ID` | Chat ID р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щ |
| `UPDATE_HISTORY_URL` | р╣Ар╕Ыр╕┤р╕Фр╕лр╕Щр╣Йр╕▓р╣Ар╕зр╣Зр╕Ър╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕нр╕▒р╕Ыр╣Ар╕Фр╕Х |

---

## ЁЯОи р╕гр╕░р╕Ър╕Ъ Theme (Lines 469-496)

р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕гр╕нр╕Зр╕гр╕▒р╕Ъ 2 р╕Шр╕╡р╕б: **Light** р╣Бр╕ер╕░ **Dark**

```python
# тЬЕ р╕кр╕Цр╕▓р╕Щр╕░: р╕Чр╕│р╕Зр╕▓р╕Щр╕Ыр╕Бр╕Хр╕┤ - р╕нр╕вр╣Ир╕▓р╣Бр╕Бр╣Йр╣Др╕В
THEME_LIGHT = {
    "app_bg": "#F2F4F7",         # р╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕Зр╕лр╕ер╕▒р╕Б
    "sidebar_bg": "#FFFFFF",     # Sidebar
    "content_bg": "#F6F7FA",     # р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Ф
    "card_bg": "#FFFFFF",        # р╕Юр╕╖р╣Йр╕Щр╕лр╕ер╕▒р╕Зр╕Бр╕▓р╕гр╣Мр╕Ф
    "card_border": "#E6E9EF",    # р╕Вр╕нр╕Ър╕Бр╕▓р╕гр╣Мр╕Ф
    "text_primary": "#1C2430",   # р╕Хр╕▒р╕зр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕лр╕ер╕▒р╕Б
    "text_muted": "#6B7785",     # р╕Хр╕▒р╕зр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕гр╕нр╕З
    "accent": "#2E7D6B",         # р╕кр╕╡р╣Ар╕Щр╣Йр╕Щ
    "accent_hover": "#276B5C",   # р╕кр╕╡р╣Ар╕Щр╣Йр╕Щр╣Ар╕бр╕╖р╣Ир╕н hover
    "search_bg": "#FFFFFF",      # р╕Кр╣Ир╕нр╕Зр╕Др╣Йр╕Щр╕лр╕▓
    "search_border": "#D8DDE6"   # р╕Вр╕нр╕Ър╕Кр╣Ир╕нр╕Зр╕Др╣Йр╕Щр╕лр╕▓
}
DEFAULT_APPEARANCE_MODE = "Light"
```

---

## ЁЯУж р╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕вр╣Ир╕нр╕в (Lines 526-859)

### р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б
```python
{
    "id": "unique_id",                    # ID р╣Ар╕Йр╕Юр╕▓р╕░
    "name": "р╕Кр╕╖р╣Ир╕нр╣Бр╕кр╕Фр╕Зр╕Ьр╕е",                  # р╕Кр╕╖р╣Ир╕нр╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕Зр╕Ър╕Щр╕Бр╕▓р╕гр╣Мр╕Ф
    "description": "р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в",             # р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф
    "type": "local_py_module",            # р╕Ыр╕гр╕░р╣Ар╕ар╕Ч (local_py_module/external_exe)
    "module_path": "filename_without_py", # р╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣Мр╣Гр╕Щ All_Programs
    "entry_point": "run_this_app",        # р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Чр╕╡р╣Ир╣Ар╕гр╕╡р╕вр╕Б
    "icon": "icon_name.ico",              # р╣Др╕нр╕Др╕нр╕Щ
    "category": "р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И",                # р╕Бр╕ер╕╕р╣Ир╕бр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б
    "enabled": True                        # р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
}
```

### р╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф (23 р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б)

#### р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И: Lychee (10 р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б)
| р╕Кр╕╖р╣Ир╕н | Module Path | р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в |
|------|-------------|----------|
| р╕кр╕гр╣Йр╕▓р╕З Itemdef р╕Ир╕▓р╕БSPSS V3 | `Program_ItemdefSPSS_Log` | р╣Бр╕Ыр╕ер╕З SPSS р╣Ар╕Ыр╣Зр╕Щ Excel |
| р╕Чр╕│ TB/T2B р╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М Itemdef V3 | `Program_T2B_Itermdef` | р╕Чр╕│ TB/T2B р╕Ир╕▓р╕Б Itemdef |
| GetValue+Promt р╣Бр╕Ыр╕░ Eng | `117_Newen_Promt` | GetValue+Copy Promt |
| р╣Бр╕Ыр╕ер╕ЗCE Otherр╕Ир╕▓р╕Б Edit V2 | `106_Map_spss_Excel` | р╣Бр╕Ыр╕ер╕Зр╣Др╕Яр╕ер╣М CE Other |
| Logic_Generator Itemdef V8 | `Logic_Generator` | GenSyntaxClean Lychee |
| р╕ер╕Ъ Sig р╕Ир╕▓р╕Б TableLychee V1 | `Del_Sig` | р╕ер╕Ъ Sig р╕Хр╕▓р╕бр╕Чр╕╡р╣Ир╕гр╕░р╕Ър╕╕ |
| Check Codes_Other V1 | `CheckOther` | Check Codes Other |
| р╣Бр╕Хр╕Б CodeNA р╕Ир╕▓р╕Б SPSS&Excel V1 | `113_ProgramCodeNA` | р╣Бр╕Хр╕Б CodeNA |
| р╕ер╕ЪN=0 OEр╣Гр╕ЩLychee V1 | `114_DelblankLychee` | р╕ер╕Ър╕Кр╣Ир╕нр╕Зр╕зр╣Ир╕▓р╕З TableOE |
| Create Format_Kao By_DP V3 | `119_Create_Format_Kao` | р╕кр╕гр╣Йр╕▓р╕З Format_Kao |

#### р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И: SPSS (5 р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б)
| р╕Кр╕╖р╣Ир╕н | Module Path | р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в |
|------|-------------|----------|
| CleanData+Frequenzy SPSS V1 | `99_CleanSPSS_Germini` | Clean Data + Frequency |
| Get SPSS V2 | `105_GetSPSS` | GenSyntax Get SPSS |
| р╕Лр╣Ир╕нр╕бр╣Др╕Яр╕ер╣МSPSS V1 | `convert_SPSS_UTF8` | р╣Бр╕Ыр╕ер╕З SPSS р╣Ар╕Ыр╣Зр╕Щ UTF-8 |
| р╣Бр╕Ыр╕ер╕Зр╣Др╕Яр╕ер╣М SPSS To Excel V1 | `ConvertSPSS_Excel` | р╣Бр╕Ыр╕ер╕З SPSS тЖТ Excel |
| MRSET Auto-Generator v5.0 | `121_SPSS_MRSET` | р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Др╣Йр╕Ф MRSET |

#### р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И: Statistic (6 р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б)
| р╕Кр╕╖р╣Ир╕н | Module Path | р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в |
|------|-------------|----------|
| Correlation р╕Ир╕▓р╕Б SPSS Data V1 | `104_Correlation` | р╕гр╕▒р╕Щ Correlation |
| BPI Brand Power Index V1 | `120_bpi` | р╕гр╕▒р╕Щ BPI |
| Multidimensional Scaling V12 | `MDS` | р╕гр╕▒р╕Щ MDS |
| р╕Фр╕╣р╕Фр╕Хр╕┤р╕Ф MA _O р╕Ир╕▓р╕Б Togo V1 | `121_Merge_MA_V2` | Merge MA |
| PSM Pricezen V1 | `122_PSM` | р╕гр╕▒р╕Щ PSM |
| BrandSence V1 | `123_Program_Run_Brandsence_Add_C All` | р╕гр╕▒р╕Щ BrandSence |

#### р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И: Excel (4 р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б)
| р╕Кр╕╖р╣Ир╕н | Module Path | р╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в |
|------|-------------|----------|
| р╕Хр╕▒р╕ФQuota Pro V1 | `99_Excel` | р╕Хр╕▒р╕Фр╕Кр╕╕р╕Фр╕Хр╕▓р╕бр╣Гр╕Ър╕Ър╕гр╕╡р╕Я |
| RenameSheet V1 | `Rename Sheet` | Rename Sheet |
| Move Sheet Excel V1 | `107_Movesheet` | Move Sheet |
| р╣Ар╕Кр╣Зр╕Д Data Excel 2 р╣Др╕Яр╕ер╣М V1 | `146_Mapdata` | р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е |

#### р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣Ир╕нр╕╖р╣Ир╕Щр╣Ж
| р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣И | р╕Кр╕╖р╣Ир╕н | Module Path |
|----------|------|-------------|
| Diary | Check Rotation Diary V1 | `109_Diary` |
| Key Norm | р╣Ар╕Бр╣Зр╕Ъ Norm V1 | `Norm_2025` |
| р╕нр╕╖р╣Ир╕Щр╣Ж | Gen Table Reporter V1 | `124_Table_Reporter` |
| р╕нр╕╖р╣Ир╕Щр╣Ж | Convert JPG to SVG V1 | `125_Convert_Icon_Svg2` |

---

## ЁЯЦея╕П р╕Др╕ер╕▓р╕кр╕лр╕ер╕▒р╕Б: AppLauncher (Lines 900-1797)

### р╣Ар╕бр╕Шр╕нр╕Фр╕кр╕│р╕Др╕▒р╕Н

#### UI Components
| р╣Ар╕бр╕Шр╕нр╕Ф | Lines | р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И |
|-------|-------|--------|
| `build_sidebar()` | 964-1056 | р╕кр╕гр╣Йр╕▓р╕З Sidebar р╕Лр╣Йр╕▓р╕в |
| `build_content()` | 1058-1105 | р╕кр╕гр╣Йр╕▓р╕Зр╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Ф |
| `apply_theme(mode)` | 1107-1196 | р╣Гр╕Кр╣Йр╕Шр╕╡р╕б Light/Dark |
| `render_program_cards()` | 1325-1361 | р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б |
| `create_card_widget(program, width)` | 1429-1467 | р╕кр╕гр╣Йр╕▓р╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╣Бр╕Хр╣Ир╕ер╕░р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б |

#### р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕вр╣Ир╕нр╕в
| р╣Ар╕бр╕Шр╕нр╕Ф | Lines | р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И |
|-------|-------|--------|
| `launch_program(program_info)` | 1738-1796 | р╣Ар╕Ыр╕┤р╕Фр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕вр╣Ир╕нр╕в |
| `run_module_entrypoint()` | 870-896 | р╕гр╕▒р╕Щр╣Вр╕бр╕Фр╕╣р╕е Python |
| `show_launching_dialog(name)` | 1469-1541 | р╣Бр╕кр╕Фр╕З Loading dialog |
| `close_launching_dialog()` | 1551-1560 | р╕Ыр╕┤р╕Ф Loading dialog |

#### р╕гр╕░р╕Ър╕Ър╕нр╕▒р╕Ыр╣Ар╕Фр╕Х
| р╣Ар╕бр╕Шр╕нр╕Ф | Lines | р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И |
|-------|-------|--------|
| `check_for_updates()` | 156-385 | р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕нр╕▒р╕Ыр╣Ар╕Фр╕Х GitHub |
| `show_changelog_if_exists()` | 434-456 | р╣Бр╕кр╕Фр╕З Changelog р╕лр╕ер╕▒р╕Зр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х |
| `create_custom_changelog_window()` | 388-431 | р╕кр╕гр╣Йр╕▓р╕Зр╕лр╕Щр╣Йр╕▓р╕Хр╣Ир╕▓р╕З Changelog |

#### р╕гр╕░р╕Ър╕Ъ Logging
| р╣Ар╕бр╕Шр╕нр╕Ф | Lines | р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И |
|-------|-------|--------|
| `log_session_to_sheet()` | 1617-1648 | р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Др╕Ы Google Sheet |
| `send_telegram_notification()` | 1650-1705 | р╕кр╣Ир╕Зр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щ Telegram |
| `_wait_and_log_session()` | 1707-1735 | р╕гр╕н process р╕Ир╕Ър╣Бр╕ер╣Йр╕з log |

---

## ЁЯФД р╕гр╕░р╕Ър╕Ъ Auto-Update (Lines 92-385)

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х
1. р╣Ар╕гр╕╡р╕вр╕Б GitHub API р╕Фр╕╢р╕З latest release
2. р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕Чр╕╡р╕вр╕Ър╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щ
3. р╕Цр╕▓р╕бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Бр╣Ир╕нр╕Щр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х
4. р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф `updater.exe` + package
5. р╕гр╕▒р╕Щ updater р╣Бр╕ер╣Йр╕зр╕Ыр╕┤р╕Фр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕лр╕ер╕▒р╕Б

### р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕кр╕Щр╕▒р╕Ър╕кр╕Щр╕╕р╕Щ
```python
# тЬЕ р╕кр╕Цр╕▓р╕Щр╕░: р╕Чр╕│р╕Зр╕▓р╕Щр╕Ыр╕Бр╕Хр╕┤
get_executable_path()           # р╕лр╕▓р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З .exe
get_updates_dir(app_dir)        # р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Ар╕Бр╣Зр╕Ъ updates
get_cached_package_path()       # р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З package cache
_normalize_tag_version(tag)     # р╕ер╕Ъ 'v' р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щ
_build_patch_chain()            # р╕кр╕гр╣Йр╕▓р╕З chain р╕кр╕│р╕лр╕гр╕▒р╕Ъ incremental update
_normalize_download_url()       # р╣Бр╕Бр╣Йр╣Др╕В URL р╕Чр╕╡р╣Ир╕Ьр╕┤р╕Ф
```

---

## ЁЯФз SPSS Path Fix (Lines 1-21)

> тЪая╕П **р╕кр╕│р╕Др╕▒р╕Нр╕бр╕▓р╕Б:** р╣Вр╕Др╣Йр╕Фр╕кр╣Ир╕зр╕Щр╕Щр╕╡р╣Йр╕Хр╣Йр╕нр╕Зр╕нр╕вр╕╣р╣Ир╕Ър╕Щр╕кр╕╕р╕Фр╕Бр╣Ир╕нр╕Щ import р╕нр╕╖р╣Ир╕Щр╣Ж

```python
# тЬЕ р╕кр╕Цр╕▓р╕Щр╕░: р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕кр╕│р╕лр╕гр╕▒р╕Ъ .exe - р╕нр╕вр╣Ир╕▓р╣Бр╕Бр╣Йр╣Др╕В!
if getattr(sys, 'frozen', False):
    # р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ SPSS_HOME р╕кр╕│р╕лр╕гр╕▒р╕Ъ savReaderWriter
    os.environ['SPSS_HOME'] = _spss_home_path
```

---

## ЁЯОЫя╕П Widget р╕Юр╕┤р╣Ар╕ир╕й: Spinner (Lines 37-69)

```python
# тЬЕ р╕кр╕Цр╕▓р╕Щр╕░: р╕Чр╕│р╕Зр╕▓р╕Щр╕Ыр╕Бр╕Хр╕┤
class Spinner(QtWidgets.QWidget):
    """Loading spinner animation widget"""
    # - р╣Гр╕Кр╣Йр╣Гр╕Щ launching dialog
    # - 12 segments р╕Юр╕гр╣Йр╕нр╕б fading alpha
    # - р╕Ыр╕гр╕▒р╕Ъ speed р╣Др╕Фр╣Й
```

---

## ЁЯУЭ Helper Functions

### Dialog Functions (Lines 501-523)
```python
show_message(parent, title, text, icon)  # р╣Бр╕кр╕Фр╕З message box
ask_yes_no(parent, title, text)          # р╕Цр╕▓р╕б Yes/No
show_error_dialog(title, text)           # р╣Бр╕кр╕Фр╕З error
```

### Resource Path (Lines 461-466)
```python
def resource_path(relative_path):
    """р╕лр╕▓ path р╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕Чр╕▒р╣Йр╕З dev р╣Бр╕ер╕░ .exe mode"""
```

---

## ЁЯУК р╕Вр╕Щр╕▓р╕Фр╣Бр╕ер╕░ Layout (Lines 861-867)

```python
ICON_SIZE = (60, 60)              # р╕Вр╕Щр╕▓р╕Фр╣Др╕нр╕Др╕нр╕Щ
CARD_DESCRIPTION_WRAPLENGTH = 150 # р╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕Зр╕Др╕│р╕нр╕Шр╕┤р╕Ър╕▓р╕в
MAX_COLUMNS = 3                   # р╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╕кр╕╣р╕Зр╕кр╕╕р╕Ф
CARD_MIN_WIDTH = 240              # р╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╕Вр╕▒р╣Йр╕Щр╕Хр╣Ир╕│
CARD_MAX_WIDTH = 2000             # р╕Др╕зр╕▓р╕бр╕Бр╕зр╣Йр╕▓р╕Зр╕Бр╕▓р╕гр╣Мр╕Фр╕кр╕╣р╕Зр╕кр╕╕р╕Ф
CARD_HEIGHT = 320                 # р╕Др╕зр╕▓р╕бр╕кр╕╣р╕Зр╕Бр╕▓р╕гр╣Мр╕Ф
```

---

## ЁЯЪА р╕Ир╕╕р╕Фр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б (Lines 1799-1877)

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ
1. `freeze_support()` - р╕кр╕│р╕лр╕гр╕▒р╕Ъ multiprocessing
2. р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ (Icon, All_Programs)
3. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ High DPI
4. р╕кр╕гр╣Йр╕▓р╕З `QApplication` р╣Бр╕ер╕░ `AppLauncher`
5. р╣Бр╕кр╕Фр╕З Changelog (р╕Цр╣Йр╕▓р╕бр╕╡)
6. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Update р╕лр╕ер╕▒р╕З 1 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡
7. р╣Бр╕кр╕Фр╕З window р╣Бр╕ер╕░р╣Ар╕Вр╣Йр╕▓ event loop

---

## тЪая╕П р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕гр╕░р╕зр╕▒р╕Зр╣Ар╕бр╕╖р╣Ир╕нр╣Бр╕Бр╣Йр╣Др╕В

### ЁЯФ┤ р╕лр╣Йр╕▓р╕бр╣Бр╕Бр╣Йр╣Др╕В
1. **SPSS Path Fix (Lines 1-21)** - р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕кр╕│р╕лр╕гр╕▒р╕Ъ .exe
2. **freeze_support()** - р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕кр╕│р╕лр╕гр╕▒р╕Ъ multiprocessing
3. **resource_path()** - р╣Гр╕Кр╣Йр╕Чр╕▒р╣Ир╕зр╕Чр╕▒р╣Йр╕Зр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б

### ЁЯЯб р╕гр╕░р╕зр╕▒р╕Зр╣Ар╕Ыр╣Зр╕Щр╕Юр╕┤р╣Ар╕ир╕й
1. **PROGRAMS list** - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ module_path р╣Гр╕лр╣Йр╕Хр╕гр╕Зр╕Бр╕▒р╕Ър╣Др╕Яр╕ер╣Мр╕Ир╕гр╕┤р╕З
2. **Theme variables** - р╕Хр╣Йр╕нр╕Зр╕бр╕╡р╕Др╕гр╕Ър╕Чр╕╕р╕Б key
3. **check_for_updates()** - logic р╕Лр╕▒р╕Ър╕Лр╣Йр╕нр╕Щ р╕бр╕╡ fallback р╕лр╕ер╕▓р╕вр╕гр╕░р╕Фр╕▒р╕Ъ

### ЁЯЯв р╣Бр╕Бр╣Йр╣Др╕Вр╣Др╕Фр╣Йр╕нр╕вр╣Ир╕▓р╕Зр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в
1. р╣Ар╕Юр╕┤р╣Ир╕бр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╣Гр╕лр╕бр╣Ир╣Гр╕Щ PROGRAMS list
2. р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Вр╕Щр╕▓р╕Ф ICON_SIZE, CARD_HEIGHT
3. р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕кр╕╡ Theme

---

## ЁЯУБ р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М

```
Main_Program/
тФЬтФАтФА Main_Program.py          # р╣Др╕Яр╕ер╣Мр╕лр╕ер╕▒р╕Б
тФЬтФАтФА updater.py               # р╕Хр╕▒р╕зр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х
тФЬтФАтФА updater.exe              # р╕Хр╕▒р╕зр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х (compiled)
тФЬтФАтФА Icon/                    # р╣Др╕нр╕Др╕нр╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
тФВ   тФЬтФАтФА I_Main.ico          # р╣Др╕нр╕Др╕нр╕Щр╕лр╕ер╕▒р╕Б
тФВ   тФФтФАтФА *.ico               # р╣Др╕нр╕Др╕нр╕Щр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕вр╣Ир╕нр╕в
тФЬтФАтФА All_Programs/            # р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕вр╣Ир╕нр╕в
тФВ   тФЬтФАтФА __init__.py         # Python package marker
тФВ   тФЬтФАтФА Program_ItemdefSPSS_Log.py
тФВ   тФЬтФАтФА 99_CleanSPSS_Germini.py
тФВ   тФФтФАтФА ... (55 files)
тФЬтФАтФА savReaderWriter/         # SPSS library
тФЬтФАтФА requirements_ttk.txt     # Dependencies
тФФтФАтФА Main_Program.spec        # PyInstaller spec
```

---

## ЁЯФЧ Dependencies р╕лр╕ер╕▒р╕Б

```
PyQt6                # GUI Framework
requests             # HTTP requests
packaging            # Version comparison
savReaderWriter      # SPSS file handling
```

---

## ЁЯУЮ р╕Хр╕┤р╕Фр╕Хр╣Ир╕н/р╣Бр╕Ир╣Йр╕Зр╕Ыр╕▒р╕Нр╕лр╕▓

- **GitHub:** [Icezy159753/my-calculator-updates](https://github.com/Icezy159753/my-calculator-updates)
- **Update History:** https://dp1234.lovable.app/

---

> **р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕:** р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Щр╕╡р╣Йр╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕╢р╣Йр╕Щр╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Ыр╣Зр╕Щ "р╕Ир╕╕р╕Ф Save" р╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б р╕лр╕▓р╕Бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕нр╕░р╣Др╕г р╣Гр╕лр╣Йр╕нр╣Йр╕▓р╕Зр╕нр╕┤р╕Зр╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Щр╕╡р╣Йр╣Ар╕Юр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Гр╕лр╣Йр╣Бр╕Бр╣Йр╣Др╕Вр╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╕Фр╕╡р╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕з
